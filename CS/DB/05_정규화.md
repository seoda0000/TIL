# 4.1 정규화란?

### 정규화의 정의

- 속성 간의 부정확한 종속성을 없애는 것
- 함수 종속 개념을 기반으로 유사한 속성들을 모으고 종속성이 없는 독립적인 속성들은 분리하는 것
- 속성의 종속성과 의존성을 분석해 더는 분해될 수 없는 엔티티로 만드는 것

### 데이터 이해 측면의 정규화

- 데이터를 완전히 이해하는 과정
- 데이터 통합, 엔티티 정의, 이력 데이터 관리를 포함
- 데이터의 성격에 맞는 엔티티 도출 → 확장성이 좋은 효과적인 모델
- 비정규화는 정규화 이후에 진행해야 한다.

- 함수 종속에 따라 이루어지므로 직관적이라기보다는 이론적인 개념이다.
-

## 정규형과 비정규형

보통 정규형이 최적이다.

### 정규형

- 업무 요건의 변경에 유연. 확장성이 좋음.
- 인덱스 수가 감소하고 특정 요건 조회 시 SQL이 단순. 단 요건에 따라 SQL이 복잡해질 수도.
- 로우 레벨로 관리되는 데이터의 자식 엔터티를 가질 수 있다.
- 엔터티의 속성이 추가될 가능성이 존재할 때 사용.

### 비정규형

- 업무 요건의 변경에 매우 취약. 즉 모델의 확장성이 좋지 않다.
- 인덱스 수가 증가하고 특정 요건 조회 시 SQL이 복잡
- 속성 레벨로 관리되는 데이터의 자식 엔터티를 가질 수 없다.
- 엔터티의 속성이 추가될 가능서잉 없을 때 사용 가능

# 4.2 정규화의 목적

### 안정성

근본적인 이유 : 중복 데이터 제거

데이터의 성격에 맞는 엔티티가 도출된다. 즉, 함수 종속을 기반으로 속성을 결정자와 종속자로 구분하여 모델 구조를 정의한다.

### 확장성

업무가 수정되거나 추가되어도 엔터티에 반영하기 수월하다. 업무 변화에 유연하게 대처할 수 있다.

데이터 저장 공간의 사용을 최소화하여 성능에 도움이 된다.

데이터 모델을 단순화하여 관리가 수월하다.

# 4.3 아노말리

### 정의

데이터 중복으로 인하여 발생하는 데이터 이상 현상.

- 정규형에서는 아노말리가 최소화되고, 반대로 중복 데이터를 채택한 모델에서는 아노말리가 발생할 수 있다.

### 아노말리의 종류

- 업데이트 아노말리 : 릴레이션에서 속성의 값을 업데이트 할 때 발생. (중복 데이터 간 부분적인 업데이트) 정규화를 통해 원천적으로 제거 가능.
- 삭제 아노말리 : 릴레이션에서 인스턴스를 삭제할 때 (의도하지 않은 데이터 삭제)
- 삽입 아노말리 : 릴레이션에서 새로운 인스턴스를 삽입할 때 (다른 데이터가 존재하지 않아 원하는 데이터를 입력할 수 없는 것)

### 중복 데이터가 항상 문제 될까? 유지할 수는 없을까?

- 중복 데이터가 존재하면, 데이터의 정합성을 맞춰야 하는 방법을 완전하게 제어할 수 없다. 애플리케이션, 담당자 교육이 모두 완전해야 한다. 중복 데이터를 최대한 없애는 근본적인 접근이 상대적으로 쉽다.

# 4.4 함수 종속

### 정의

관계형 모델을 설계할 때 가장 중요한 데이터 종속성

<aside>
📑 데이터 종속성

- 함수 종속 (Functional Dependecy)
- 다가 종속 (Multivalued Dependency)
- 조인 종속 (Join Dependency)
</aside>

- 릴레이션 내에 존재하는 속성 간의 종속성
- 대표 속성(식별자)와 나머지 속성 사이의 연관관계
- 업무 요건에 종속

- 결정자 X : 속성 간의 종속성을 규명할 때 기준이 되는 값
- 종속자 Y : 결정자의 값에 의해 정해지는 값
- 속성 Y가 속성 X에 의해 함수적으로 종속된다 = 속성 X의 값을 이용해 속성 Y의 값을 유일하게 식별할 수 있다. X의 값에 대해 Y의 값이 오직 하나만 연관되어 있다.
- 결정자 X의 값은 반드시 하나의 Y값과 연관된다.

### X→Y (직접 종속)

- y = f(x)
- ex) 주민등록번호 : 결정자
- 모든 결정자는 엔티티의 주 식별자가 되어야 한다.

### X→Y→Z (이행 종속)

- X와 Y를 하나의 엔터티로, Y와 Z를 하나의 엔터티로 처리한다.
- X의 폐포 : X, Y, Z

<aside>
📑 **F의 폐포(closure of F : F+)**

- FD 집합 F 에 의해 추론될 수 있는 모든 FD들의 집합
- F 의 폐포 F+는 암스트롱의 공리 라고 하는 3가지 법칙을 반복 적용하여 계산 가능
</aside>

<aside>
📑 **암스트롱의 공리(Armstrong’s Axiom : AA)**

- 재귀규칙: X ⊇Y 이면, X →Y
- 부가규칙: X →Y 이면, X Z →Y Z
- 이행규칙: X →Y 이고 Y →Z 이면, X →Z
</aside>

<aside>
📑 알아두면 편리한 추가 규칙

- 결합규칙 : X → Y 이고 X → Z 이면, X → Y Z
- 분해규칙 : X → Y Z 이면, X → Y 이고 X → Z
- 가이행 규칙 : X → Y 이고 Y Z → Ω 이면, X Z → Ω
- X, Y, Z : 릴레이션 스키마 R 에 속한 속성들의 집합, XY : X ∪Y
</aside>

<aside>
📑 ***속성 X의 폐포(X+)***

- X가 함수 종속하는 모든 속성들의 집합
- 함수 종속 X → Y 가 F + 에 속하는지를 알아보기 위해, F 에 대하여 속성 X 의 폐포 X + 를 계산하여 판단
- 특정 속성의 폐포에 릴레이션의 전체 속성을 포함하고 있을 때, 그 속성은 키가 된다.
- **X+ 계산 Algorithm**
  ```
  closure = X;

  repeat until (no change to closure) {
  if (U ⊆ closure and U → V ∈F )
          closure = closure ∪ V;
  }
  ```

</aside>
