# pjt04 í”„ë ˆì„ì›Œí¬ ê¸°ë°˜ ì›¹ í˜ì´ì§€ êµ¬í˜„
ì„œìš¸ 1ë°˜ ì„œë‹¤ê²½ 220901


![Untitled](./images/pjt04/index.png)

---

## view

* movies/views.py
```python
from contextlib import redirect_stderr, redirect_stdout
from multiprocessing import context
from turtle import title
from django.shortcuts import render, redirect
from .models import Movie
# Create your views here.
def index(request):
    movies = Movie.objects.all()
    context = {
        'movies' : movies
    }
    return render(request, 'movies/index.html', context)

def new(request):
    return render(request, 'movies/new.html')

def create(request):
    movie = Movie()
    movie.title = request.POST.get('title')
    movie.audience = request.POST.get('audience')
    movie.release_date = request.POST.get('release_date')
    movie.genre = request.POST.get('genre')
    movie.score = request.POST.get('score')
    movie.poster_url = request.POST.get('poster_url')
    movie.description = request.POST.get('description')
    movie.save()
    return redirect('movies:detail', movie.pk)

def detail(request, pk):
    movie = Movie.objects.get(pk=pk)
    context = {'movie' : movie,}
    return render(request, 'movies/detail.html', context)

def edit(request, pk):
    movie = Movie.objects.get(pk=pk)
    context = {'movie':movie}
    return render(request, 'movies/edit.html', context)

def update(request, pk):
    movie = Movie.objects.get(pk=pk)
    movie.title = request.POST.get('title')
    movie.audience = request.POST.get('audience')
    movie.release_date = request.POST.get('release_date')
    movie.genre = request.POST.get('genre')
    movie.score = request.POST.get('score')
    movie.poster_url = request.POST.get('poster_url')
    movie.description = request.POST.get('description')
    movie.save()
    return redirect('movies:detail', movie.pk)

def delete(request, pk):
    movie = Movie.objects.get(pk=pk)
    movie.delete()
    return redirect('movies:index')
```

---

## templates

![Untitled](./images/pjt04/index.png)
* movies/template/movies/index.html
```HTML
{% extends 'base.html' %}

{% block content %}
  <h1 class="text-center"><b>INDEX</b></h1>
  <p class="text-center"><a href="{% url 'movies:new' %}">[NEW]</a></p>
  <hr>

    <div class="container col-9">
      <div class="row row-cols-1 row-cols-md-3 g-4">

        {% for movie in movies %}
          <div class="col">
            <div class="card h-100 text-bg-white d-flex position-relative">
              <img src="{{movie.poster_url}}" class="card-img-top" alt="{{movie.title}}">
              <div class="card-body">
                <h5 class="card-title">{{movie.title}}</h5>
                <p class="card-text text-end">â­{{movie.score}}</p>
                <a href="{% url 'movies:detail' movie.pk %}" class="stretched-link bg-white border-white"></a>
              </div>
            </div>
          </div>
        {% endfor %}

      </div>
    </div>

<br>
{% endblock content %}

```
* ê° ê°œì²´ë§ˆë‹¤ ë¶€íŠ¸ìŠ¤íŠ¸ë©ì˜ ì¹´ë“œê·¸ë£¹ì„ ì ìš©í–ˆë‹¤.

<br>


![Untitled](./images/pjt04/new.png)
* movies/template/movies/new.html

```HTML
{% extends 'base.html' %}

{% block content %}
  <h1><b>NEW</b></h1>
  <hr>

  <form action="{% url 'movies:create' %}" method="POST">
    {% csrf_token %}

    <label for="title">TITLE</label><br>
    <input type="text" name="title" id="title"><br><br>

    <label for="audience">AUDIENCE</label><br>
    <input type="number" name="audience" id="audience"><br><br>


    <label for="release_date">RELEASE_DATE</label><br>
    <input type="date" name="release_date" id="release_date"><br><br>

    <label for="genre">GENRE</label><br>
    <select name="genre" id="genre">
      <option value="ë“œë¼ë§ˆ">ë“œë¼ë§ˆ</option>
      <option value="ì½”ë¯¸ë””">ì½”ë¯¸ë””</option>
      <option value="ì•¡ì…˜">ì•¡ì…˜</option>
      <option value="íŒíƒ€ì§€/SF">íŒíƒ€ì§€/SF</option>
      <option value="ì• ë‹ˆë©”ì´ì…˜">ì• ë‹ˆë©”ì´ì…˜</option>
    </select><br><br>

    <label for="score">SCORE</label><br>
    <input type="number" step="0.01" name="score" id="score"><br><br>

    <label for="poster_url">POSTER_URL</label><br>
    <input type="url" name="poster_url" id="poster_url"><br><br>

    <label for="description">DESCRIPTION</label><br>
    <textarea name="description" id="description" cols="30" rows="10"></textarea><br><br>

    <input type="submit" value="Submit">

  </form><br><br>

  <hr>
  <a href="{% url 'movies:index' %}">BACK</a>

{% endblock content %}
```

<br>

![Untitled](./images/pjt04/detail.png)
* movies/template/movies/detail.html
```HTML
{% extends 'base.html' %}
{% load humanize %}

{% block content %}

  <h1 class="text-center"><b>DETAIL</b></h1>
  <hr>

  <div class="row px-7">
    <img src="{{movie.poster_url}}" alt="{{movie.title}}" class="col-5"><br><br>

    <div class="col-5 align-items-center mx-auto">
      <h3 class="text-center py-3">{{movie.title}}</h3>

      <p>Audience: {{movie.audience|intcomma}}ëª…</p>
      <p>Release Date: {{movie.release_date}}</p>
      <p>Genre: {{movie.genre}}</p>
      <p>Score: {{movie.score}}</p>
      <p>{{movie.description}}</p>

      <a href="{% url 'movies:edit' movie.pk %}">EDIT</a>

      <form action="{% url 'movies:delete' movie.pk %}" method="POST">
        {% csrf_token %}
        <input type="submit" value="DELETE">
      </form>
      <a href="{% url 'movies:index' %}">BACK</a>
    </div>
    
  </div>

{% endblock content %}
```

<br>

![Untitled](./images/pjt04/edit.png)
* movies/template/movies/edit.html
```HTML
{% extends 'base.html' %}

{% block content %}
  <h1><b>EDIT</b></h1>
  <hr>

  <form action="{% url 'movies:update' movie.pk %}" method="POST">
    {% csrf_token %}

    <label for="title">TITLE</label><br>
    <input type="text" name="title" id="title" value="{{movie.title}}"><br><br>

    <label for="audience">AUDIENCE</label><br>
    <input type="number" name="audience" id="audience" value="{{movie.audience}}"><br><br>


    <label for="release_date">RELEASE_DATE</label><br>
    <input type="date" name="release_date" id="release_date" value="{{movie.release_date|date:'Y-m-d'}}" required><br><br>

    <label for="genre">GENRE</label><br>
    <select name="genre" id="genre">
      <option value="{{movie.genre}}">{{movie.genre}}</option>
      <option value="ë“œë¼ë§ˆ">ë“œë¼ë§ˆ</option>
      <option value="ì½”ë¯¸ë””">ì½”ë¯¸ë””</option>
      <option value="ì•¡ì…˜">ì•¡ì…˜</option>
      <option value="íŒíƒ€ì§€/SF">íŒíƒ€ì§€/SF</option>
      <option value="ì• ë‹ˆë©”ì´ì…˜">ì• ë‹ˆë©”ì´ì…˜</option>
    </select><br><br>

    <label for="score">SCORE</label><br>
    <input type="number" step="0.01" name="score" id="score" value="{{movie.score}}"><br><br>

    <label for="poster_url">POSTER_URL</label><br>
    <input type="url" name="poster_url" id="poster_url" value="{{movie.poster_url}}"><br><br>

    <label for="description">DESCRIPTION</label><br>
    <textarea name="description" id="description" cols="30" rows="10"> {{movie.description}} </textarea><br><br>

    <input type="submit" value="Submit">

  </form><br><br>

  <hr>
  <a href="{% url 'movies:index' %}">BACK</a>

{% endblock content %}
```

---

## Review

#### ğŸ’¡ ìƒˆë¡œ ë°°ìš´ ê²ƒë“¤

##### 1. editì‹œ ê¸°ì¡´ ë‚ ì§œ ë°ì´í„°ë¥¼ ê¸°ë³¸ ë°ì´í„°ë¡œ ì„¤ì •í•˜ê¸°
```HTML
<label for="release_date">RELEASE_DATE</label><br>
<input type="date" name="release_date" id="release_date" value="{{movie.release_date|date:'Y-m-d'}}" required>
```
* value ì„¤ì •ì‹œ ë‚ ì§œ í˜•ì‹ì„ ë§ì¶°ì•¼ ë°ì´í„°ê°€ ì…ë ¥ëœë‹¤.

<br>

##### 2. editì‹œ ê¸°ì¡´ ì½¤ë³´ìƒì ì„ íƒì§€ë¥¼ ê¸°ë³¸ ë°ì´í„°ë¡œ ì„¤ì •í•˜ê¸°
```HTML
<select name="genre" id="genre">
  <option value="{{movie.genre}}">{{movie.genre}}</option>
  <option value="ë“œë¼ë§ˆ">ë“œë¼ë§ˆ</option>
  <option value="ì½”ë¯¸ë””">ì½”ë¯¸ë””</option>
  <option value="ì•¡ì…˜">ì•¡ì…˜</option>
  <option value="íŒíƒ€ì§€/SF">íŒíƒ€ì§€/SF</option>
  <option value="ì• ë‹ˆë©”ì´ì…˜">ì• ë‹ˆë©”ì´ì…˜</option>
</select><br><br>
```
* selectë¥¼ ì´ìš©í–ˆë‹¤.
* ì²˜ìŒì—” value ê°’ì„ ì„¤ì •í•˜ì§€ ì•Šì•„ ë°ì´í„°ê°€ ë¹„ì—ˆë‹¤. ë°ì´í„°ë¥¼ ê¼¼ê¼¼íˆ ì±„ì›Œì¤˜ì•¼ í•œë‹¤. 

##### 3. í•¨ìˆ˜ íˆ¬ì…ê³¼ ì‚°ì¶œì„ ìƒê°í•˜ë©´ viewsê°€ ì‰½ë‹¤.

##### 4. intí˜•ì‹ ì§€ì •í•˜ê¸°
```python
#settings.py
INSTALLED_APPS = [
    'movies',
    'django_extensions',
    'django.contrib.humanize',
    ...]
```
```HTML
<!-- ìƒë‹¨ -->
{% load humanize %} 
...
<p>Audience: {{movie.audience|intcomma}}ëª…</p>
```
* ìˆ«ìì— ì‰¼í‘œ ê¸°í˜¸ë¥¼ ë„£ê³  ì‹¶ì„ ë•ŒëŠ” ì´ë ‡ê²Œ ì„¤ì •í•˜ë©´ ëœë‹¤.

---

### ëŠë‚€ ì 

* ì„œë²„ë¥¼ êµ¬í˜„í•˜ê³  ë¶€íŠ¸ìŠ¤íŠ¸ë©ì„ ì ìš©í•˜ì ë¹„êµì  ì™„ì„±ëœ ì›¹ í˜ì´ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤.
* ë¶€íŠ¸ìŠ¤íŠ¸ë©ê³¼ css, HTMLì„ ë§ì´ ìŠì–´ì„œ ë³µìŠµì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.
* Newë‚˜ Editì²˜ëŸ¼ ì‚¬ìš©ìê°€ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ì›¹í˜ì´ì§€ëŠ” ì–´ë–»ê²Œ í•˜ë©´ ë” í¸ë¦¬í•œì§€ ìœ ì‹¬íˆ ì‚´í´ë³´ê³  ì‹¶ë‹¤.
* ê¸°ì¡´ ê°’ì— ë”°ë¼ ì½¤ë³´ë°•ìŠ¤ì˜ selected ë¥¼ ìˆ˜ì •í•˜ê³  ì‹¶ì—ˆì§€ë§Œ JavaScriptê°€ í•„ìš”í–ˆë‹¤. ì´í›„ ë°°ì›Œì„œ ë³´ì™„í•˜ê³  ì‹¶ë‹¤.
