# pjt05 DBë¥¼í™œìš©í•œì›¹í˜ì´ì§€êµ¬í˜„
ì„œìš¸ 1ë°˜ ì„œë‹¤ê²½ 221007

![Untitled](./images/pjt05/index.png)
![Untitled](./images/pjt05/detail.png)

---


## model
#### ğŸ’¡ ìƒˆë¡œ êµ¬í˜„í•œ ê²ƒë“¤
* ì„ íƒìê°€ ìˆëŠ” íŠ¹ì„±(Genre)ì„ ëª¨ë¸ì—ì„œ êµ¬í˜„í–ˆë‹¤.
```python
from django.db import models
from datetime import date
from django import forms

# Create your models here.
class Movie(models.Model):
    title = models.CharField(max_length=20)
    audience = models.IntegerField()
    release_date = models.DateField(default=date.today)
    GENRE_CHOICES = [
        ('comedy', 'ì½”ë¯¸ë””'),
        ('horror', 'ê³µí¬'),
        ('romance', 'ë¡œë§¨ìŠ¤'),
    ]
    genre = models.CharField(
        max_length=30, choices=GENRE_CHOICES, default='comedy',
        )
    score = models.FloatField()
    poster_url = models.TextField()
    description = models.TextField()

    def __str__(self):
        return self.title
```

---

## view
#### ğŸ’¡ ìƒˆë¡œ êµ¬í˜„í•œ ê²ƒë“¤
* CRUDë¥¼ êµ¬í˜„í•˜ê³  decoratorë„ ì¶”ê°€í–ˆë‹¤.

```python
# movies/views.py
from django.shortcuts import render, redirect
from .models import Movie
from .forms import MovieForm
from django.views.decorators.http import require_http_methods, require_GET

@require_GET
def index(request):
    movies = Movie.objects.all()
    context = {
        'movies': movies,
    }
    return render(request, 'movies/index.html', context)


@require_http_methods(["GET", "POST"])
def create(request):
    if request.method == 'POST':
        form = MovieForm(request.POST)
        if form.is_valid():
            movie = form.save()
            return redirect('movies:detail', movie.pk)
    else:
        form = MovieForm()
    context = {
        'form': form,
    }
    return render(request, 'movies/create.html', context)


@require_GET
def detail(request, pk):
    movie = Movie.objects.get(pk=pk)
    context = {
        'movie': movie,
    }
    return render(request, 'movies/detail.html', context)


@require_http_methods(["GET", "POST"])
def update(request, pk):
    movie = Movie.objects.get(pk=pk)
    if request.method == 'POST':
        form = MovieForm(request.POST, instance=movie)
        if form.is_valid():
            form.save()
            return redirect('movies:detail', movie.pk)
    else:
        form = MovieForm(instance=movie)
    context = {
        'movie': movie,
        'form': form,
    }
    return render(request, 'movies/update.html', context)


@require_GET
def delete(request, pk):
    movie = Movie.objects.get(pk=pk)
    movie.delete()
    return redirect('movies:index')
```

---

## forms
#### ğŸ’¡ ìƒˆë¡œ êµ¬í˜„í•œ ê²ƒë“¤

* ë¶€íŠ¸ìŠ¤íŠ¸ë©ì˜ form control ìŠ¤íƒ€ì¼ì„ formsì— ìœ„ì ¯ìœ¼ë¡œ ì ìš©í•´ì£¼ì—ˆë‹¤.
![Untitled](./images/pjt05/create.png)
![Untitled](./images/pjt05/update.png)

```python
from django import forms
from .models import Movie

class MovieForm(forms.ModelForm):
    title = forms.CharField(
        max_length=20,
        widget=forms.TextInput(
            attrs={
                'class': 'form-control',
            }
        )
    )
    audience = forms.IntegerField(
        widget=forms.NumberInput(
            attrs={
                'class': 'form-control',
            }
        )
    )
    release_date = forms.DateField(
        widget=forms.DateInput(
            attrs={
                'class': 'form-control',
            }
        )
    )
    poster_url = forms.CharField(
        widget=forms.TextInput(
            attrs={
                'class': 'form-control',
            }
        )
    )
    description = forms.CharField(
        widget=forms.Textarea(
            attrs={
                'class': 'form-control',
                'rows' : 8,
            }
        )
    )
    score = forms.FloatField(
        max_value=5.0,
        min_value=0.0, 
        widget=forms.NumberInput(
            attrs={
                'id': 'form_score',
                'step': "0.5",
                'class': 'form-control',
            }
        ),
    )

    class Meta:
        model = Movie
        fields = '__all__'
```

---


# templates
#### ğŸ’¡ ìƒˆë¡œ êµ¬í˜„í•œ ê²ƒë“¤
* reset ë²„íŠ¼ì„ ì¶”ê°€í•˜ì˜€ë‹¤.

```html
# movies/templpates/movies/update.html
{% extends 'base.html' %}
{% block content %}
  <h1><b>UPDATE</b></h1>
  <hr>

  <form action="{% url 'movies:update' movie.pk %}" method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" class="btn btn-primary">
    <input type="reset" class="btn btn-primary" value="CANCEL">
  </form>
  <hr>
  <a href="{% url 'movies:index' %}" class="btn btn-info">BACK</a>
{% endblock content %}

```
---


### ëŠë‚€ ì 
* CRUD êµ¬í˜„ì— ì œë²• ìµìˆ™í•´ì ¸ì„œ ë¿Œë“¯í•˜ë‹¤.
* widget êµ¬í˜„ì‹œ ê³µì‹ ë¬¸ì„œë¥¼ í™œìš©í•˜ì˜€ë‹¤. ìƒê°ë³´ë‹¤ ë” ì–´ë ¤ì›€ì´ ìˆì—ˆë‹¤... ìµìˆ™í•´ì§ˆ ë•Œê¹Œì§€ ìì£¼ ì¨ì•¼í•  ê²ƒ ê°™ë‹¤.
* ë””ìì¸ ë° í”„ë¡ íŠ¸ êµ¬í˜„ì´ ìƒê°ë³´ë‹¤ ê¹Œë‹¤ë¡­ë‹¤. ë¶€ìŠ¤íŠ¸íŠ¸ë© ë³µìŠµì´ í•„ìš”í•˜ë‹¤.
* ë¶€íŠ¸ìŠ¤íŠ¸ë©ê³¼ ì¥ê³ ë¥¼ ì—°ê²°í•˜ëŠ” extensionì´ ìˆë‹¤ê³  í•˜ëŠ”ë° ë‹¤ìŒì—ëŠ” ì°¾ì•„ë´ì•¼ê² ë‹¤. ì½”ë“œê°€ ë„ˆë¬´ ë°˜ë³µë˜ì—ˆë‹¤!
